using InfinityScript;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace AntiForceClass
{
    public class Anti_ForceClass : BaseScript
    {
        public Anti_ForceClass()
        {
            PlayerConnected += Anti_ForceClass_PlayerConnected;
            Log.Info("Anti-ForceClass Loaded by astro for old IS");
        }

        private void Anti_ForceClass_PlayerConnected(Entity obj)
        {
            AntiForceClass(obj);
            obj.SpawnedPlayer += () =>
            {
                AntiForceClass(obj);
            };
        }

        internal static void AntiCheatBanClient(Entity obj, string v)
        {
            Utilities.ExecuteCommand($"banclient {obj.EntRef} ^0[^5Anti-ForceClass^0]");
            using (StreamWriter str = new StreamWriter(@"scripts`\AntiCheatLogs.txt", true))
            {
                str.WriteLine("[AntiCheat]: Anti-" + v + ": " + obj.Name + "::DSR=" + Function.Call<string>("getdvar", "sv_current_dsr") + "::Weapon=" + obj.CurrentWeapon);
                str.Flush();
            }
        }

        internal static void AntiForceClass(Entity obj)
        {
            string Players2Directory = @"players2\";
            string[] DSR = File.ReadAllLines(Players2Directory + Function.Call<string>("getdvar", "sv_current_dsr"));
            for (int i = 0; i < DSR.Length; i++)
            {
                string line = DSR[i];
                // Anti Attachment
                if (line.StartsWith("gameOpt commonOption.attachmentRestricted.acog \"1\"") && obj.CurrentWeapon.Contains("acog") || line.StartsWith("gameOpt commonOption.attachmentRestricted.akimbo \"1\"") && obj.CurrentWeapon.Contains("akimbo") || line.StartsWith("gameOpt commonOption.attachmentRestricted.eotech \"1\"") && obj.CurrentWeapon.Contains("eotech") || line.StartsWith("gameOpt commonOption.attachmentRestricted.gl \"1\"") && obj.CurrentWeapon.Contains("gl") || line.StartsWith("gameOpt commonOption.attachmentRestricted.grip \"1\"") && obj.CurrentWeapon.Contains("grip") || line.StartsWith("gameOpt commonOption.attachmentRestricted.hamrhybrid \"1\"") && obj.CurrentWeapon.Contains("hamrhybrid") || line.StartsWith("gameOpt commonOption.attachmentRestricted.heartbeat \"1\"") && obj.CurrentWeapon.Contains("heartbeat") || line.StartsWith("gameOpt commonOption.attachmentRestricted.hybrid \"1\"") && obj.CurrentWeapon.Contains("hybrid") || line.StartsWith("gameOpt commonOption.attachmentRestricted.m320 \"1\"") && obj.CurrentWeapon.Contains("m320") || line.StartsWith("gameOpt commonOption.attachmentRestricted.reflex \"1\"") && obj.CurrentWeapon.Contains("reflex") || line.StartsWith("gameOpt commonOption.attachmentRestricted.rof \"1\"") && obj.CurrentWeapon.Contains("rof") || line.StartsWith("gameOpt commonOption.attachmentRestricted.shotgun \"1\"") && obj.CurrentWeapon.Contains("shotgun") || line.StartsWith("gameOpt commonOption.attachmentRestricted.silencer \"1\"") && obj.CurrentWeapon.Contains("silencer") || line.StartsWith("gameOpt commonOption.attachmentRestricted.silencer02 \"1\"") && obj.CurrentWeapon.Contains("silencer02") || line.StartsWith("gameOpt commonOption.attachmentRestricted.silencer03 \"1\"") && obj.CurrentWeapon.Contains("silencer03") || line.StartsWith("gameOpt commonOption.attachmentRestricted.tactical \"1\"") && obj.CurrentWeapon.Contains("tactical") || line.StartsWith("gameOpt commonOption.attachmentRestricted.thermal \"1\"") && obj.CurrentWeapon.Contains("thermal") || line.StartsWith("gameOpt commonOption.attachmentRestricted.vzscope \"1\"") && obj.CurrentWeapon.Contains("vzscope") || line.StartsWith("gameOpt commonOption.attachmentRestricted.xmags \"1\"") && obj.CurrentWeapon.Contains("xmags"))
                {
                    AntiCheatBanClient(obj, "ForceClass");
                    return;
                }
                if (line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_1887 \"1\"") && obj.CurrentWeapon.Contains("iw5_1887") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_44magnum \"1\"") && obj.CurrentWeapon.Contains("iw5_44magnum") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_aa12 \"1\"") && obj.CurrentWeapon.Contains("iw5_aa12") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_acr \"1\"") && obj.CurrentWeapon.Contains("iw5_acr") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_ak47 \"1\"") && obj.CurrentWeapon.Contains("iw5_ak47") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_as50 \"1\"") && obj.CurrentWeapon.Contains("iw5_as50") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_barrett \"1\"") && obj.CurrentWeapon.Contains("iw5_barrett") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_cm901 \"1\"") && obj.CurrentWeapon.Contains("iw5_cm901") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_deserteagle \"1\"") && obj.CurrentWeapon.Contains("iw5_deserteagle") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_dragunov \"1\"") && obj.CurrentWeapon.Contains("iw5_dragunov") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_fad \"1\"") && obj.CurrentWeapon.Contains("iw5_fad") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_fmg9 \"1\"") && obj.CurrentWeapon.Contains("iw5_fmg9") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_fnfiveseven \"1\"") && obj.CurrentWeapon.Contains("iw5_fnfiveseven") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_g18 \"1\"") && obj.CurrentWeapon.Contains("iw5_g18") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_g36c \"1\"") && obj.CurrentWeapon.Contains("iw5_g36c") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_ksg \"1\"") && obj.CurrentWeapon.Contains("iw5_ksg") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_l96a1 \"1\"") && obj.CurrentWeapon.Contains("iw5_l96a1") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_m16 \"1\"") && obj.CurrentWeapon.Contains("iw5_m16") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_m4 \"1\"") && obj.CurrentWeapon.Contains("iw5_m4") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_m60 \"1\"") && obj.CurrentWeapon.Contains("iw5_m60") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_m9 \"1\"") && obj.CurrentWeapon.Contains("iw5_m9") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mg36 \"1\"") && obj.CurrentWeapon.Contains("iw5_mg36") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mk14 \"1\"") && obj.CurrentWeapon.Contains("iw5_mk14") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mk46 \"1\"") && obj.CurrentWeapon.Contains("iw5_mk46") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mp412 \"1\"") && obj.CurrentWeapon.Contains("iw5_mp412") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mp5 \"1\"") && obj.CurrentWeapon.Contains("iw5_mp5") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mp7 \"1\"") && obj.CurrentWeapon.Contains("iw5_mp7") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_mp9 \"1\"") && obj.CurrentWeapon.Contains("iw5_mp9") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_msr \"1\"") && obj.CurrentWeapon.Contains("iw5_msr") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_p90 \"1\"") && obj.CurrentWeapon.Contains("iw5_p90") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_p99 \"1\"") && obj.CurrentWeapon.Contains("iw5_p99") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_pecheneg \"1\"") && obj.CurrentWeapon.Contains("iw5_pecheneg") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_pp90m1 \"1\"") && obj.CurrentWeapon.Contains("iw5_pp90m1") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_rsass \"1\"") && obj.CurrentWeapon.Contains("iw5_rsass") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_sa80 \"1\"") && obj.CurrentWeapon.Contains("iw5_sa80") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_scar \"1\"") && obj.CurrentWeapon.Contains("iw5_scar") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_skorpion \"1\"") && obj.CurrentWeapon.Contains("iw5_skorpion") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_smaw \"1\"") && obj.CurrentWeapon.Contains("iw5_smaw") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_spas12 \"1\"") && obj.CurrentWeapon.Contains("iw5_spas12") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_striker \"1\"") && obj.CurrentWeapon.Contains("iw5_striker") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_type95 \"1\"") && obj.CurrentWeapon.Contains("iw5_type95") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_ump45 \"1\"") && obj.CurrentWeapon.Contains("iw5_ump45") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_usas12 \"1\"") && obj.CurrentWeapon.Contains("iw5_usas12") || line.StartsWith("gameOpt commonOption.weaponRestricted.iw5_usp45 \"1\"") && obj.CurrentWeapon.Contains("iw5_usp45") || line.StartsWith("gameOpt commonOption.weaponRestricted.javelin \"1\"") && obj.CurrentWeapon.Contains("javelin") || line.StartsWith("gameOpt commonOption.weaponRestricted.m320 \"1\"") && obj.CurrentWeapon.Contains("m320") || line.StartsWith("gameOpt commonOption.weaponRestricted.riotshield \"1\"") && obj.CurrentWeapon.Contains("riotshield") || line.StartsWith("gameOpt commonOption.weaponRestricted.rpg \"1\"") && obj.CurrentWeapon.Contains("rpg") || line.StartsWith("gameOpt commonOption.weaponRestricted.stinger \"1\"") && obj.CurrentWeapon.Contains("stinger") || line.StartsWith("gameOpt commonOption.weaponRestricted.xm25 \"1\"") && obj.CurrentWeapon.Contains("xm25"))
                {
                    AntiCheatBanClient(obj, "ForceClass");
                    return;
                }
                if (line.StartsWith("gameOpt commonOption.perkRestricted._specialty_blastshield \"1\"") && GetOffhandSecondaryClass(obj).Contains("_specialty_blastshield") || line.StartsWith("gameOpt commonOption.perkRestricted.bouncingbetty_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("bouncingbetty_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.c4_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("c4_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.claymore_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("claymore_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.concussion_grenade_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("concussion_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.emp_grenade_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("emp_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.flash_grenade_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("flash_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.frag_grenade_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("frag_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.semtex_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("semtex_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.smoke_grenade_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("smoke_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_autospot \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_autospot") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_blindeye \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_blindeye") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_bling \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_bling") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_bulletaccuracy \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_bulletaccuracy") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_c4death \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_c4death") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_coldblooded \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_coldblooded") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_detectexplosive \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_detectexplosive") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_fastermelee \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_fastermelee") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_fastreload \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_fastreload") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_finalstand \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_finalstand") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_grenadepulldeath \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_grenadepulldeath") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_hardline \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_hardline") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_holdbreathwhileads \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_holdbreathwhileads") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_juiced \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_juiced") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_lightweight \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_lightweight") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_longerrange \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_longerrange") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_longersprint \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_longersprint") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_marksman \"1\"") && GetOffhandSecondaryClass(obj).Contains("pecialty_marksman") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_moredamage \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_moredamage") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_paint \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_paint") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_portable_radar \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_portable_radar") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_quickdraw \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_quickdraw") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_quieter \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_quieter") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_reducedsway \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_reducedsway") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_revenge \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_revenge") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_scavenger \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_scavenger") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_scrambler \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_scrambler") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_sharp_focus \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_sharp_focus") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_stalker \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_stalker") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_stopping_power \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_stopping_power") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_tacticalinsertion \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_tacticalinsertion") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_twoprimaries \"1\"") && GetOffhandSecondaryClass(obj).Contains("specialty_twoprimaries") || line.StartsWith("gameOpt commonOption.perkRestricted.throwingknife_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("hrowingknife_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.trophy_mp \"1\"") && GetOffhandSecondaryClass(obj).Contains("trophy_mp"))
                {
                    AntiCheatBanClient(obj, "ForceClass");
                    return;
                }
                if (line.StartsWith("gameOpt commonOption.perkRestricted._specialty_blastshield \"1\"") && GetOffhandPrimaryClass(obj).Contains("_specialty_blastshield") || line.StartsWith("gameOpt commonOption.perkRestricted.bouncingbetty_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("bouncingbetty_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.c4_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("c4_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.claymore_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("claymore_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.concussion_grenade_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("concussion_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.emp_grenade_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("emp_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.flash_grenade_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("flash_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.frag_grenade_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("frag_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.semtex_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("semtex_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.smoke_grenade_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("smoke_grenade_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_autospot \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_autospot") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_blindeye \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_blindeye") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_bling \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_bling") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_bulletaccuracy \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_bulletaccuracy") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_c4death \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_c4death") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_coldblooded \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_coldblooded") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_detectexplosive \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_detectexplosive") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_fastermelee \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_fastermelee") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_fastreload \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_fastreload") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_finalstand \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_finalstand") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_grenadepulldeath \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_grenadepulldeath") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_hardline \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_hardline") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_holdbreathwhileads \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_holdbreathwhileads") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_juiced \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_juiced") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_lightweight \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_lightweight") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_longerrange \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_longerrange") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_longersprint \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_longersprint") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_marksman \"1\"") && GetOffhandPrimaryClass(obj).Contains("pecialty_marksman") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_moredamage \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_moredamage") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_paint \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_paint") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_portable_radar \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_portable_radar") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_quickdraw \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_quickdraw") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_quieter \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_quieter") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_reducedsway \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_reducedsway") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_revenge \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_revenge") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_scavenger \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_scavenger") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_scrambler \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_scrambler") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_sharp_focus \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_sharp_focus") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_stalker \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_stalker") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_stopping_power \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_stopping_power") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_tacticalinsertion \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_tacticalinsertion") || line.StartsWith("gameOpt commonOption.perkRestricted.specialty_twoprimaries \"1\"") && GetOffhandPrimaryClass(obj).Contains("specialty_twoprimaries") || line.StartsWith("gameOpt commonOption.perkRestricted.throwingknife_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("hrowingknife_mp") || line.StartsWith("gameOpt commonOption.perkRestricted.trophy_mp \"1\"") && GetOffhandPrimaryClass(obj).Contains("trophy_mp"))
                {
                    AntiCheatBanClient(obj, "ForceClass");
                    return;
                }
            }
        }
        private static string GetOffhandPrimaryClass(Entity ent)
        {
            return Function.Call<string>("getoffhandprimaryclass", ent);
        }
        private static string GetOffhandSecondaryClass(Entity ent)
        {
            return Function.Call<string>("getoffhandsecondaryclass", ent);
        }
    }
}
